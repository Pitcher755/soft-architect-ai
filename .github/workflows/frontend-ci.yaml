name: ğŸ“± Frontend CI Pipeline

on:
  workflow_call:

jobs:
  frontend-tests:
    name: ğŸ¨ Frontend Quality & Tests
    runs-on: ubuntu-latest

    steps:
      - name: âœ… Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ¦ Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: 'latest'
          channel: 'stable'

      - name: ğŸ“¦ Get Flutter Dependencies
        run: |
          cd src/client
          flutter pub get
          flutter doctor -v

      - name: ğŸ” Flutter Analyze
        run: |
          cd src/client
          flutter analyze

      - name: ğŸ§ª Flutter Tests
        run: |
          cd src/client
          flutter test --coverage || true

      - name: ğŸ—ï¸ Build Desktop (Linux)
        if: runner.os == 'Linux'
        run: |
          cd src/client
          flutter build linux --release || flutter build linux || true

      - name: ğŸ“Š Dependency Health Check
        run: |
          cd src/client
          flutter pub outdated --exit-code 0 || true

      - name: âœ¨ Format Check (Dart)
        run: |
          cd src/client
          dart format --set-exit-if-changed . || true
